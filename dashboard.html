<script>
  if (window.netlifyIdentity) {

    netlifyIdentity.on("init", user => {
      if (!user) {
        // BELUM login â†’ tunggu login
        netlifyIdentity.on("login", user => {
          location.reload();
        });
      } else {
        // SUDAH login
        document.getElementById("status").innerText =
          "Login sebagai: " + user.email;

        const roles = user.app_metadata?.roles || [];
        if (roles.includes("admin")) {
          document.getElementById("adminPanel").style.display = "block";
        }
      }
    });

  } else {
    document.getElementById("status").innerText = "Netlify Identity tidak tersedia";
  }
</script>
